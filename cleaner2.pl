use strict;use Cwd;use utf8;my $dir = getcwd;my $fileToClean = $ARGV[0];open(FILE,"<",$fileToClean) or die "Error: can't open $fileToClean: $!\n";my @lines = <FILE>;close(FILE);open(OUT, ">",$fileToClean."_cleaned") or die "Error can't open to write $fileToClean: $!\n";foreach(@lines){	my $line = trim($_);	$line =~ s/<(.*?)>//gi;	$line = replaceCharacters($line);	my @tokens = split(/\s+/,$line);	if ($#tokens > 5)	{		print OUT $line."\n";	}}close(OUT);#verification 1: fileSize > 1024 Bytesmy $fileSize = -s $fileToClean."_cleaned";if ($fileSize < 1023){	unlink($fileToClean."_cleaned");}#verification 2: UTF-8 ou ISO-8859-1 (this last is converted to UTF-8)my $codeFlag = 0;system("file -i ".$fileToClean."_cleaned > tempOutShell");open(TMP,"<tempOutShell");foreach(<TMP>){	if ($_ =~ /utf\-8/i)	{		$codeFlag = 1;	}	if ($_ =~ /iso\-8859\-1/i)	{		system("iconv --from-code=ISO-8859-1 --to-code=UTF-8 ".$fileToClean."_cleaned > ".$fileToClean."_cleaned_converted");		unlink($fileToClean."_cleaned");		#system("mv ".$fileToClean."_cleaned_tmp ".$fileToClean."_cleaned");		$codeFlag = 1;	}}close(TMP);unlink("tempOutShell");if ($codeFlag == 0){	unlink($fileToClean."_cleaned");}sub trim($){ my $string = shift; $string =~ s/^\s+//; $string =~ s/\s+$//; return $string;}sub replaceCharacters{	my $string = shift;		$string =~ s/&Aacute;/Á/g;  $string =~ s/&aacute;/á/g;  $string =~ s/&Acirc;/Â/g;  $string =~ s/&acirc;/â/g;  $string =~ s/&Agrave;/À/g;  $string =~ s/&agrave;/à/g;  $string =~ s/&Aring;/Å/g;  $string =~ s/&aring;/å/g;  $string =~ s/&Atilde;/Ã/g;  $string =~ s/&atilde;/ã/g;  $string =~ s/&Auml;/Ä/g;  $string =~ s/&auml;/ä/g;  $string =~ s/&AElig;/Æ/g;  $string =~ s/&aelig;/æ/g;  $string =~ s/&Eacute;/É/g;  $string =~ s/&eacute;/é/g;  $string =~ s/&Ecirc;/Ê/g;  $string =~ s/ecirc;/ê/g;  $string =~ s/&Egrave;/È/g;  $string =~ s/&egrave;/è/g;  $string =~ s/&Euml;/Ë/g;  $string =~ s/&euml;/ë/g;  $string =~ s/&ETH;/Ð/g;  $string =~ s/&eth;/ð/g;  $string =~ s/&Iacute;/Í/g;  $string =~ s/&iacute;/í/g;  $string =~ s/&Icirc;/Î/g;  $string =~ s/&icirc;/î/g;  $string =~ s/&Igrave;/Ì/g;  $string =~ s/&igrave;/ì/g;  $string =~ s/&Iuml;/Ï/g;  $string =~ s/&iuml;/ï/g;  $string =~ s/&Oacute;/Ó/g;  $string =~ s/&oacute;/ó/g;  $string =~ s/&Ocirc;/Ô/g;  $string =~ s/&ocirc;/ô/g;  $string =~ s/&Ograve;/Ò/g;  $string =~ s/&ograve;/ò/g;  $string =~ s/&Oslash;/Ø/g;  $string =~ s/&oslash;/ø/g;  $string =~ s/&Otilde;/Õ/g;  $string =~ s/&otilde;/õ/g;  $string =~ s/&Ouml;/Ö/g;  $string =~ s/&ouml;/ö/g;  $string =~ s/&Uacute;/Ú/g;  $string =~ s/&uacute;/ú/g;  $string =~ s/&Ucirc;/Û/g;  $string =~ s/&ucirc;/û/g;  $string =~ s/&Ugrave;/Ù/g;  $string =~ s/&ugrave;/ù/g;  $string =~ s/&Uuml;/Ü/g;  $string =~ s/&uuml;/ü/g;  $string =~ s/&Ccedil;/Ç/g;  $string =~ s/&ccedil;/ç/g;  $string =~ s/&Ntilde;/Ñ/g;  $string =~ s/&ntilde;/ñ/g;  $string =~ s/&lt;/</g;  $string =~ s/&gt;/>/g;  $string =~ s/&amp;/&/g;  $string =~ s/&quot;/"/g;  $string =~ s/&reg;/®/g;  $string =~ s/&copy;/©/g;  $string =~ s/&Yacute;/Ý/g;  $string =~ s/&yacute;/ý/g;  $string =~ s/&THORN;/Þ/g;  $string =~ s/&thorn;/þ/g;  $string =~ s/&szlig;/ß/g;  $string =~ s/&nbsp;/ /g;  $string =~ s/&ldquo;/"/g;  $string =~ s/&rdquo;/"/g;$string =~ s/\&#8211;/\-/g; $string =~ s/\&#8212;/\-/g;  $string =~ s/\&#33;/\!/g; $string =~ s/\&#65;/A/g; $string =~ s/\&#97;/a/g; $string =~ s/\&#163;/£/g; $string =~ s/\&#195;/Ã/g; $string =~ s/\&#227;/ã/g; $string =~ s/\&#34;/"/g; $string =~ s/\&#66;/B/g; $string =~ s/\&#98;/b/g; $string =~ s/\&#164;/¤/g; $string =~ s/\&#196;/Ä/g; $string =~ s/\&#228;/ä/g; $string =~ s/\&#35;/#/g; $string =~ s/\&#67;/C/g; $string =~ s/\&#99;/c/g; $string =~ s/\&#165;/¥/g; $string =~ s/\&#197;/Å/g; $string =~ s/\&#229;/å/g; $string =~ s/\&#36;/\$/g; $string =~ s/\&#68;/D/g; $string =~ s/\&#100;/d/g; $string =~ s/\&#166;/\¦/g; $string =~ s/\&#198;/Æ/g; $string =~ s/\&#230;/æ/g; $string =~ s/\&#37;/\%/g; $string =~ s/\&#69;/E/g; $string =~ s/\&#101;/e/g; $string =~ s/\&#167;/§/g; $string =~ s/\&#199;/Ç/g; $string =~ s/\&#231;/ç/g; $string =~ s/\&#38;/\&/g; $string =~ s/\&#70;/F/g; $string =~ s/\&#102;/f/g; $string =~ s/\&#168;/\¨/g; $string =~ s/\&#200;/È/g; $string =~ s/\&#232;/è/g; $string =~ s/\&#39;/\'/g; $string =~ s/\&#71;/G/g; $string =~ s/\&#103;/g/g; $string =~ s/\&#169;/©/g; $string =~ s/\&#201;/É/g; $string =~ s/\&#233;/é/g; $string =~ s/\&#40;/\(/g; $string =~ s/\&#72;/H/g; $string =~ s/\&#104;/h/g; $string =~ s/\&#170;/ª/g; $string =~ s/\&#202;/Ê/g; $string =~ s/\&#234;/ê/g; $string =~ s/\&#41;/\)/g; $string =~ s/\&#73;/I/g; $string =~ s/\&#105;/i/g; $string =~ s/\&#171;/«/g; $string =~ s/\&#203;/Ë/g; $string =~ s/\&#235;/ë/g; $string =~ s/\&#42;/\*/g; $string =~ s/\&#74;/J/g; $string =~ s/\&#106;/j/g; $string =~ s/\&#172;/\¬/g; $string =~ s/\&#204;/Ì/g; $string =~ s/\&#236;/ì/g; $string =~ s/\&#43;/\+/g; $string =~ s/\&#75;/K/g; $string =~ s/\&#107;/k/g; $string =~ s/\&#173;/­ /g; $string =~ s/\&#205;/Í/g; $string =~ s/\&#237;/í/g; $string =~ s/\&#44;/,/g; $string =~ s/\&#76;/L/g; $string =~ s/\&#108;/l/g; $string =~ s/\&#174;/®/g; $string =~ s/\&#206;/Î/g; $string =~ s/\&#238;/î/g; $string =~ s/\&#45;/\-/g; $string =~ s/\&#77;/M/g; $string =~ s/\&#109;/m/g; $string =~ s/\&#175;/\¯/g; $string =~ s/\&#207;/Ï/g; $string =~ s/\&#239;/ï/g; $string =~ s/\&#46;/\./g; $string =~ s/\&#78;/N/g; $string =~ s/\&#110;/n/g; $string =~ s/\&#176;/°/g; $string =~ s/\&#208;/Ð/g; $string =~ s/\&#240;/ð/g; $string =~ s/\&#47;/\//g; $string =~ s/\&#79;/O/g; $string =~ s/\&#111;/o/g; $string =~ s/\&#177;/±/g; $string =~ s/\&#209;/Ñ/g; $string =~ s/\&#241;/ñ/g; $string =~ s/\&#48;/0/g; $string =~ s/\&#80;/P/g; $string =~ s/\&#112;/p/g; $string =~ s/\&#178;/²/g; $string =~ s/\&#210;/Ò/g; $string =~ s/\&#242;/ò/g; $string =~ s/\&#49;/1/g; $string =~ s/\&#81;/Q/g; $string =~ s/\&#113;/q/g; $string =~ s/\&#179;/³/g; $string =~ s/\&#211;/Ó/g; $string =~ s/\&#243;/ó/g; $string =~ s/\&#50;/2/g; $string =~ s/\&#82;/R/g; $string =~ s/\&#114;/r/g; $string =~ s/\&#180;/\´/g; $string =~ s/\&#212;/Ô/g; $string =~ s/\&#244;/ô/g; $string =~ s/\&#51;/3/g; $string =~ s/\&#83;/S/g; $string =~ s/\&#115;/s/g; $string =~ s/\&#181;/µ/g; $string =~ s/\&#213;/Õ/g; $string =~ s/\&#245;/õ/g; $string =~ s/\&#52;/4/g; $string =~ s/\&#84;/T/g; $string =~ s/\&#116;/t/g; $string =~ s/\&#182;/¶/g; $string =~ s/\&#214;/Ö/g; $string =~ s/\&#246;/ö/g; $string =~ s/\&#53;/5/g; $string =~ s/\&#85;/U/g; $string =~ s/\&#117;/u/g; $string =~ s/\&#183;/\·/g; $string =~ s/\&#215;/\×/g; $string =~ s/\&#247;/\÷/g; $string =~ s/\&#54;/6/g; $string =~ s/\&#86;/V/g; $string =~ s/\&#118;/v/g; $string =~ s/\&#184;/\¸/g; $string =~ s/\&#216;/Ø/g; $string =~ s/\&#248;/ø/g; $string =~ s/\&#55;/7/g; $string =~ s/\&#87;/W/g; $string =~ s/\&#119;/w/g; $string =~ s/\&#185;/¹/g; $string =~ s/\&#217;/Ù/g; $string =~ s/\&#249;/ù/g; $string =~ s/\&#56;/8/g; $string =~ s/\&#88;/X/g; $string =~ s/\&#120;/x/g; $string =~ s/\&#186;/º/g; $string =~ s/\&#218;/Ú/g; $string =~ s/\&#250;/ú/g; $string =~ s/\&#57;/9/g; $string =~ s/\&#89;/Y/g; $string =~ s/\&#121;/y/g; $string =~ s/\&#187;/\»/g; $string =~ s/\&#219;/Û/g; $string =~ s/\&#251;/û/g; $string =~ s/\&#58;/\:/g; $string =~ s/\&#90;/Z/g; $string =~ s/\&#122;/z/g; $string =~ s/\&#188;/¼/g; $string =~ s/\&#220;/Ü/g; $string =~ s/\&#252;/ü/g; $string =~ s/\&#59;/\;/g; $string =~ s/\&#91;/\[/g; $string =~ s/\&#123;/\{/g; $string =~ s/\&#189;/½/g; $string =~ s/\&#221;/Ý/g; $string =~ s/\&#253;/ý/g; $string =~ s/\&#60;/\</g; $string =~ s/\&#92;/\\/g; $string =~ s/\&#124;/\|/g; $string =~ s/\&#190;/¾/g; $string =~ s/\&#222;/Þ/g; $string =~ s/\&#254;/þ/g; $string =~ s/\&#61;/\=/g; $string =~ s/\&#93;/\]/g; $string =~ s/\&#125;/\}/g; $string =~ s/\&#191;/\¿/g; $string =~ s/\&#223;/ß/g; $string =~ s/\&#255;/ÿ/g; $string =~ s/\&#62;/\>/g; $string =~ s/\&#94;/\^/g; $string =~ s/\&#126;/\~/g; $string =~ s/\&#192;/À/g; $string =~ s/\&#224;/à/g; $string =~ s/\&#256;/Ā/g; $string =~ s/\&#63;/\?/g; $string =~ s/\&#95;/_/g; $string =~ s/\&#161;/¡/g; $string =~ s/\&#193;/Á/g; $string =~ s/\&#225;/á/g; $string =~ s/\&#64;/\@/g; $string =~ s/\&#96;/\`/g; $string =~ s/\&#162;/¢/g; $string =~ s/\&#194;/Â/g; $string =~ s/\&#226;/â/g;		return $string;}